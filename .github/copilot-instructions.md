<!-- Copilot / AI agent guidance for idnofunny-app -->
# idnofunny-app — AI coding agent instructions

Purpose: give an AI agent the minimal, actionable context to be productive in this React + Vite + Ionic codebase.

Quick summary
- Frameworks: React (function components), Vite dev server, Ionic React UI components.
- Networking: `src/services/api.js` uses `axios` with a request interceptor that reads `localStorage.token` and sets `Authorization: Bearer <token>`.
- Image flow: client-side editing via `react-filerobot-image-editor` in `src/pages/Upload.jsx`; editor saves as base64 -> converted to Blob -> uploaded to backend via `api.post('/memes', formData)`.

Big picture & architecture
- Single-page app using React + Ionic for UI and `react-router-dom` (v5) for navigation. Example: `useHistory()` usage and routes push to `/tabs/feed` in `src/pages/Upload.jsx`.
- API calls centralized in `src/services/api.js`. Update `VITE_API_BASE_URL` (env) when backend endpoint changes.
- Local optimistic UI patterns: comments are updated locally in `src/components/CommentsModal.jsx` after successful POST, and parent components are notified via `onCommentAdded` callbacks.

Key developer workflows
- Start dev server: `npm run dev` (uses `vite`).
- Build: `npm run build`.
- Preview production build: `npm run preview`.
- Lint: `npm run lint` (ESLint rules are minimal; watch for react-hooks warnings).

Project-specific conventions & patterns
- Auth: token stored in `localStorage` and automatically attached by axios interceptor in `src/services/api.js`.
- API error handling: components inspect `error.response` / `error.request`; prefer surfacing `error.response.data.detail` when present (see `Upload.jsx`).
- Image editor: the project intentionally inserts inline CSS overrides inside `Upload.jsx` to modify Filerobot UI (e.g., hide textual Cancel button). When changing editor behavior keep these overrides in mind.
- Filenames: components live under `src/components/` and pages under `src/pages/`. Use existing patterns (functional components, hooks) when adding new code.

Integration points & external deps to watch
- Backend API: configured with `VITE_API_BASE_URL` (env). Default fallback: `http://localhost:8000` inside `src/services/api.js`.
- Image editor: `react-filerobot-image-editor` — editing returns `imageBase64` which this app converts to a Blob before upload (see `handleSave` in `Upload.jsx`).
- Ionic React: UI patterns follow Ionic components (IonPage, IonContent, IonModal, IonToast, IonLoading). Follow Ionic spacing and CSS variables declared under `src/theme/variables.css`.

When making changes — concrete tips
- If you change auth flow, update `src/services/api.js` interceptor and search for direct `localStorage.getItem('token')` usages.
- When modifying upload flow, keep these steps: select file -> createObjectURL -> open editor -> onSave convert base64 to Blob -> append to FormData -> `api.post('/memes', formData)`.
- If adding routes, note repo uses `react-router-dom@5` (`useHistory` and string paths). Mirror existing route style in `src/main.jsx` / `src/App.jsx`.
- For visual fixes to Filerobot, prefer inline style blocks in `Upload.jsx` near the editor instance so the scope is explicit.

Files to inspect first (examples)
- `src/services/api.js` — axios instance, env fallback, auth interceptor.
- `src/pages/Upload.jsx` — image selection, editor integration, upload flow, inline CSS overrides.
- `src/components/CommentsModal.jsx` — comments UI and optimistic update pattern.
- `src/theme/variables.css` — global Ionic theming variables.

Questions for the maintainer (ask the user if unclear)
- Are there any undocumented environment variables or backend behaviors (rate limits, upload size limits, required fields) the agent should know?
- Any preferred branching, commit message, or code style rules beyond ESLint? (e.g., PR size limits, commit prefixes)

If you want edits, say which area to update (API, Upload flow, styling, or onboarding docs).

---
Generated by an AI-assisted repo sweep. Please review and tell me any gaps to iterate.
